; ******************************************************
; BASIC .ASM template file for AVR
; ******************************************************

.include "C:\VMLAB\include\m8def.inc"

; Define here the variables
;
.def  temp  =r16

; Define here Reset and interrupt vectors, if any
;
reset:
   rjmp start
   reti      ; Addr $01
   reti      ; Addr $02
   reti      ; Addr $03
   reti      ; Addr $04
   reti      ; Addr $05
   reti      ; Addr $06        Use 'rjmp myVector'
   reti      ; Addr $07        to define a interrupt vector
   reti      ; Addr $08
   reti      ; Addr $09
   reti      ; Addr $0A
   reti      ; Addr $0B        This is just an example
   reti      ; Addr $0C        Not all MCUs have the same
   reti      ; Addr $0D        number of interrupt vectors
   reti      ; Addr $0E
   reti      ; Addr $0F
   reti      ; Addr $10

; Program starts here after Reset
;
start:

  LDI R16,0X03
  MOV XH,R16
  LDI R16,0X00
  MOV XL,R16   ;

  LDI R16,0X04
  MOV YH,R16
  LDI R16,0X00
  MOV YL,R16

forever:
  LDI R16,0X03
  LDI R17,0X04
  LDI R18,0X05
  MOV R1,R16
  ADD R16,R17
  IN R24,SREG
  OUT SPH,XH
  OUT SPL,XL
  PUSH R24
  PUSH R16
  PUSH R1
  PUSH R17
  PUSH R18

  IN R20,SPH
  IN R21,SPL

  LDI R16,0X02
  LDI R17,0X03
  LDI R18,0X04
  MOV R1,R18
  SUB R18,R17
  IN R24,SREG
  OUT SPH,YH
  OUT SPL,YL
  PUSH R1
  PUSH R16
  PUSH R17
  PUSH R18

  IN R22,SPH
  IN R23,SPL

  OUT SPH,R20
  OUT SPL,R21

  POP R16
  POP R17
  POP R18
  POP R1
  POP R24
  OUT SREG,R24
 rjmp forever








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































